import { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';
import { PlotlyService } from './plotly.service';
import { PlotlySharedModule } from './plotly-shared.module';
import * as i0 from "@angular/core";
import * as i1 from "./plotly.service";
export class PlotlyViaCDNModule {
    static { this.plotlyBundle = undefined; }
    static { this.plotlyVersion = 'latest'; }
    static { this.plotlyBundleNames = ['basic', 'cartesian', 'geo', 'gl3d', 'gl2d', 'mapbox', 'finance']; }
    constructor(plotlyService) {
        this.plotlyService = plotlyService;
        PlotlyService.setModuleName('ViaCDN');
    }
    static setPlotlyVersion(version, cdnProvider = 'plotly', cdnURL = '') {
        const isOk = version === 'latest' || /^(strict-)?\d\.\d{1,2}\.\d{1,2}$/.test(version);
        if (!isOk) {
            throw new Error(`Invalid plotly version. Please set 'latest' or version number (i.e.: 1.4.3) or strict version number (i.e.: strict-1.4.3)`);
        }
        PlotlyViaCDNModule.loadViaCDN(cdnProvider, cdnURL);
        PlotlyViaCDNModule.plotlyVersion = version;
    }
    static setPlotlyBundle(bundle) {
        const isOk = bundle === null || PlotlyViaCDNModule.plotlyBundleNames.indexOf(bundle) >= 0;
        if (!isOk) {
            const names = PlotlyViaCDNModule.plotlyBundleNames.map(n => `"${n}"`).join(', ');
            throw new Error(`Invalid plotly bundle. Please set to null for full or ${names} for a partial bundle.`);
        }
        PlotlyViaCDNModule.plotlyBundle = bundle;
    }
    static loadViaCDN(cdnProvider = 'plotly', cdnURL = '') {
        PlotlyService.setPlotly('waiting');
        const init = () => {
            let src = '';
            switch (cdnProvider) {
                case 'cloudflare':
                    if (PlotlyViaCDNModule.plotlyVersion == 'latest') {
                        throw new Error(`As cloudflare hosts version specific files, 'latest' as a version is not supported. Please specify a version or you can choose 'plotly' as a CDN provider.`);
                    }
                    src = PlotlyViaCDNModule.plotlyBundle == null
                        ? `https://cdnjs.cloudflare.com/ajax/libs/plotly.js/${PlotlyViaCDNModule.plotlyVersion}/plotly.min.js`
                        : `https://cdnjs.cloudflare.com/ajax/libs/plotly.js/${PlotlyViaCDNModule.plotlyVersion}/plotly-${PlotlyViaCDNModule.plotlyBundle}.min.js`;
                    break;
                case 'custom':
                    if (!(!!cdnURL && typeof cdnURL === 'string')) {
                        throw new Error(`Invalid or missing CDN URL. Please provide a CDN URL in case of custom provider. Alternatively, you can choose from 'plotly' or 'cloudflare'.`);
                    }
                    src = cdnURL;
                    break;
                default:
                    src = PlotlyViaCDNModule.plotlyBundle == null
                        ? `https://cdn.plot.ly/plotly-${PlotlyViaCDNModule.plotlyVersion}.min.js`
                        : `https://cdn.plot.ly/plotly-${PlotlyViaCDNModule.plotlyBundle}-${PlotlyViaCDNModule.plotlyVersion}.min.js`;
                    break;
            }
            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = src;
            script.onerror = () => console.error(`Error loading plotly.js library from ${src}`);
            const head = document.getElementsByTagName('head')[0];
            head.appendChild(script);
            let counter = 200; // equivalent of 10 seconds...
            const fn = () => {
                const plotly = window.Plotly;
                if (plotly) {
                    PlotlyService.setPlotly(plotly);
                }
                else if (counter > 0) {
                    counter--;
                    setTimeout(fn, 50);
                }
                else {
                    throw new Error(`Error loading plotly.js library from ${src}. Timeout.`);
                }
            };
            fn();
        };
        setTimeout(init);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: PlotlyViaCDNModule, deps: [{ token: i1.PlotlyService }], target: i0.ɵɵFactoryTarget.NgModule }); }
    static { this.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: "14.0.0", version: "16.2.12", ngImport: i0, type: PlotlyViaCDNModule, imports: [CommonModule, PlotlySharedModule], exports: [PlotlySharedModule] }); }
    static { this.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: PlotlyViaCDNModule, providers: [PlotlyService], imports: [CommonModule, PlotlySharedModule, PlotlySharedModule] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: PlotlyViaCDNModule, decorators: [{
            type: NgModule,
            args: [{
                    declarations: [],
                    imports: [CommonModule, PlotlySharedModule],
                    providers: [PlotlyService],
                    exports: [PlotlySharedModule],
                }]
        }], ctorParameters: function () { return [{ type: i1.PlotlyService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGxvdGx5LXZpYS1jZG4ubW9kdWxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvcGxvdGx5L3NyYy9saWIvcGxvdGx5LXZpYS1jZG4ubW9kdWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDekMsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRS9DLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNqRCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQzs7O0FBWTVELE1BQU0sT0FBTyxrQkFBa0I7YUFDWixpQkFBWSxHQUFzQixTQUFTLENBQUM7YUFDNUMsa0JBQWEsR0FBRyxRQUFRLENBQUM7YUFDMUIsc0JBQWlCLEdBQXVCLENBQUMsT0FBTyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFFekgsWUFBbUIsYUFBNEI7UUFBNUIsa0JBQWEsR0FBYixhQUFhLENBQWU7UUFDM0MsYUFBYSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUMxQyxDQUFDO0lBRU0sTUFBTSxDQUFDLGdCQUFnQixDQUFDLE9BQWUsRUFBRSxjQUFpQyxRQUFRLEVBQUUsU0FBaUIsRUFBRTtRQUMxRyxNQUFNLElBQUksR0FBRyxPQUFPLEtBQUssUUFBUSxJQUFJLGtDQUFrQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUN0RixJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1AsTUFBTSxJQUFJLEtBQUssQ0FBQywySEFBMkgsQ0FBQyxDQUFDO1NBQ2hKO1FBRUQsa0JBQWtCLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRSxNQUFNLENBQUMsQ0FBQztRQUNuRCxrQkFBa0IsQ0FBQyxhQUFhLEdBQUcsT0FBTyxDQUFDO0lBQy9DLENBQUM7SUFFTSxNQUFNLENBQUMsZUFBZSxDQUFDLE1BQStCO1FBQ3pELE1BQU0sSUFBSSxHQUFHLE1BQU0sS0FBSyxJQUFJLElBQUksa0JBQWtCLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMxRixJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1AsTUFBTSxLQUFLLEdBQUcsa0JBQWtCLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNqRixNQUFNLElBQUksS0FBSyxDQUFDLHlEQUF5RCxLQUFLLHdCQUF3QixDQUFDLENBQUM7U0FDM0c7UUFFRCxrQkFBa0IsQ0FBQyxZQUFZLEdBQUcsTUFBTSxDQUFDO0lBQzdDLENBQUM7SUFFTSxNQUFNLENBQUMsVUFBVSxDQUFDLGNBQWlDLFFBQVEsRUFBRSxTQUFpQixFQUFFO1FBQ25GLGFBQWEsQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7UUFFbkMsTUFBTSxJQUFJLEdBQUcsR0FBRyxFQUFFO1lBQ2QsSUFBSSxHQUFHLEdBQVcsRUFBRSxDQUFDO1lBQ3JCLFFBQVEsV0FBVyxFQUFFO2dCQUNqQixLQUFLLFlBQVk7b0JBQ2IsSUFBSSxrQkFBa0IsQ0FBQyxhQUFhLElBQUksUUFBUSxFQUFFO3dCQUM5QyxNQUFNLElBQUksS0FBSyxDQUFDLDRKQUE0SixDQUFDLENBQUM7cUJBQ2pMO29CQUNELEdBQUcsR0FBRyxrQkFBa0IsQ0FBQyxZQUFZLElBQUksSUFBSTt3QkFDekMsQ0FBQyxDQUFDLG9EQUFvRCxrQkFBa0IsQ0FBQyxhQUFhLGdCQUFnQjt3QkFDdEcsQ0FBQyxDQUFDLG9EQUFvRCxrQkFBa0IsQ0FBQyxhQUFhLFdBQVcsa0JBQWtCLENBQUMsWUFBWSxTQUFTLENBQUM7b0JBQzlJLE1BQU07Z0JBQ1YsS0FBSyxRQUFRO29CQUNULElBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLElBQUksT0FBTyxNQUFNLEtBQUssUUFBUSxDQUFDLEVBQUU7d0JBQzFDLE1BQU0sSUFBSSxLQUFLLENBQUMsK0lBQStJLENBQUMsQ0FBQztxQkFDcEs7b0JBQ0QsR0FBRyxHQUFHLE1BQU0sQ0FBQztvQkFDYixNQUFNO2dCQUNWO29CQUNJLEdBQUcsR0FBRyxrQkFBa0IsQ0FBQyxZQUFZLElBQUksSUFBSTt3QkFDekMsQ0FBQyxDQUFDLDhCQUE4QixrQkFBa0IsQ0FBQyxhQUFhLFNBQVM7d0JBQ3pFLENBQUMsQ0FBQyw4QkFBOEIsa0JBQWtCLENBQUMsWUFBWSxJQUFJLGtCQUFrQixDQUFDLGFBQWEsU0FBUyxDQUFDO29CQUNqSCxNQUFNO2FBQ2I7WUFFRCxNQUFNLE1BQU0sR0FBc0IsUUFBUSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNuRSxNQUFNLENBQUMsSUFBSSxHQUFHLGlCQUFpQixDQUFDO1lBQ2hDLE1BQU0sQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDO1lBQ2pCLE1BQU0sQ0FBQyxPQUFPLEdBQUcsR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyx3Q0FBd0MsR0FBRyxFQUFFLENBQUMsQ0FBQztZQUVwRixNQUFNLElBQUksR0FBb0IsUUFBUSxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3ZFLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7WUFFekIsSUFBSSxPQUFPLEdBQUcsR0FBRyxDQUFDLENBQUMsOEJBQThCO1lBRWpELE1BQU0sRUFBRSxHQUFHLEdBQUcsRUFBRTtnQkFDWixNQUFNLE1BQU0sR0FBSSxNQUFjLENBQUMsTUFBTSxDQUFDO2dCQUN0QyxJQUFJLE1BQU0sRUFBRTtvQkFDUixhQUFhLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2lCQUNuQztxQkFBTSxJQUFJLE9BQU8sR0FBRyxDQUFDLEVBQUU7b0JBQ3BCLE9BQU8sRUFBRyxDQUFDO29CQUNYLFVBQVUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7aUJBQ3RCO3FCQUFNO29CQUNILE1BQU0sSUFBSSxLQUFLLENBQUMsd0NBQXdDLEdBQUcsWUFBWSxDQUFDLENBQUM7aUJBQzVFO1lBQ0wsQ0FBQyxDQUFDO1lBRUYsRUFBRSxFQUFFLENBQUM7UUFDVCxDQUFDLENBQUM7UUFFRixVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDckIsQ0FBQzsrR0FsRlEsa0JBQWtCO2dIQUFsQixrQkFBa0IsWUFKakIsWUFBWSxFQUFFLGtCQUFrQixhQUVoQyxrQkFBa0I7Z0hBRW5CLGtCQUFrQixhQUhoQixDQUFDLGFBQWEsQ0FBQyxZQURoQixZQUFZLEVBQUUsa0JBQWtCLEVBRWhDLGtCQUFrQjs7NEZBRW5CLGtCQUFrQjtrQkFOOUIsUUFBUTttQkFBQztvQkFDTixZQUFZLEVBQUUsRUFBRTtvQkFDaEIsT0FBTyxFQUFFLENBQUMsWUFBWSxFQUFFLGtCQUFrQixDQUFDO29CQUMzQyxTQUFTLEVBQUUsQ0FBQyxhQUFhLENBQUM7b0JBQzFCLE9BQU8sRUFBRSxDQUFDLGtCQUFrQixDQUFDO2lCQUNoQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5nTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcblxyXG5pbXBvcnQgeyBQbG90bHlTZXJ2aWNlIH0gZnJvbSAnLi9wbG90bHkuc2VydmljZSc7XHJcbmltcG9ydCB7IFBsb3RseVNoYXJlZE1vZHVsZSB9IGZyb20gJy4vcGxvdGx5LXNoYXJlZC5tb2R1bGUnO1xyXG5cclxuXHJcbmV4cG9ydCB0eXBlIFBsb3RseUJ1bmRsZU5hbWUgPSAnYmFzaWMnIHwgJ2NhcnRlc2lhbicgfCAnZ2VvJyB8ICdnbDNkJyB8ICdnbDJkJyB8ICdtYXBib3gnIHwgJ2ZpbmFuY2UnO1xyXG5leHBvcnQgdHlwZSBQbG90bHlDRE5Qcm92aWRlciA9ICdwbG90bHknIHwgJ2Nsb3VkZmxhcmUnIHwgJ2N1c3RvbSc7XHJcblxyXG5ATmdNb2R1bGUoe1xyXG4gICAgZGVjbGFyYXRpb25zOiBbXSxcclxuICAgIGltcG9ydHM6IFtDb21tb25Nb2R1bGUsIFBsb3RseVNoYXJlZE1vZHVsZV0sXHJcbiAgICBwcm92aWRlcnM6IFtQbG90bHlTZXJ2aWNlXSxcclxuICAgIGV4cG9ydHM6IFtQbG90bHlTaGFyZWRNb2R1bGVdLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgUGxvdGx5VmlhQ0ROTW9kdWxlIHtcclxuICAgIHByaXZhdGUgc3RhdGljIHBsb3RseUJ1bmRsZT86IFBsb3RseUJ1bmRsZU5hbWUgPSB1bmRlZmluZWQ7XHJcbiAgICBwcml2YXRlIHN0YXRpYyBwbG90bHlWZXJzaW9uID0gJ2xhdGVzdCc7XHJcbiAgICBwdWJsaWMgc3RhdGljIHBsb3RseUJ1bmRsZU5hbWVzOiBQbG90bHlCdW5kbGVOYW1lW10gPSBbJ2Jhc2ljJywgJ2NhcnRlc2lhbicsICdnZW8nLCAnZ2wzZCcsICdnbDJkJywgJ21hcGJveCcsICdmaW5hbmNlJ107XHJcblxyXG4gICAgY29uc3RydWN0b3IocHVibGljIHBsb3RseVNlcnZpY2U6IFBsb3RseVNlcnZpY2UpIHtcclxuICAgICAgICBQbG90bHlTZXJ2aWNlLnNldE1vZHVsZU5hbWUoJ1ZpYUNETicpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgc2V0UGxvdGx5VmVyc2lvbih2ZXJzaW9uOiBzdHJpbmcsIGNkblByb3ZpZGVyOiBQbG90bHlDRE5Qcm92aWRlciA9ICdwbG90bHknLCBjZG5VUkw6IHN0cmluZyA9ICcnKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgaXNPayA9IHZlcnNpb24gPT09ICdsYXRlc3QnIHx8IC9eKHN0cmljdC0pP1xcZFxcLlxcZHsxLDJ9XFwuXFxkezEsMn0kLy50ZXN0KHZlcnNpb24pO1xyXG4gICAgICAgIGlmICghaXNPaykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgcGxvdGx5IHZlcnNpb24uIFBsZWFzZSBzZXQgJ2xhdGVzdCcgb3IgdmVyc2lvbiBudW1iZXIgKGkuZS46IDEuNC4zKSBvciBzdHJpY3QgdmVyc2lvbiBudW1iZXIgKGkuZS46IHN0cmljdC0xLjQuMylgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFBsb3RseVZpYUNETk1vZHVsZS5sb2FkVmlhQ0ROKGNkblByb3ZpZGVyLCBjZG5VUkwpO1xyXG4gICAgICAgIFBsb3RseVZpYUNETk1vZHVsZS5wbG90bHlWZXJzaW9uID0gdmVyc2lvbjtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHNldFBsb3RseUJ1bmRsZShidW5kbGU6IFBsb3RseUJ1bmRsZU5hbWUgfCBudWxsKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgaXNPayA9IGJ1bmRsZSA9PT0gbnVsbCB8fCBQbG90bHlWaWFDRE5Nb2R1bGUucGxvdGx5QnVuZGxlTmFtZXMuaW5kZXhPZihidW5kbGUpID49IDA7XHJcbiAgICAgICAgaWYgKCFpc09rKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWVzID0gUGxvdGx5VmlhQ0ROTW9kdWxlLnBsb3RseUJ1bmRsZU5hbWVzLm1hcChuID0+IGBcIiR7bn1cImApLmpvaW4oJywgJyk7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBwbG90bHkgYnVuZGxlLiBQbGVhc2Ugc2V0IHRvIG51bGwgZm9yIGZ1bGwgb3IgJHtuYW1lc30gZm9yIGEgcGFydGlhbCBidW5kbGUuYCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBQbG90bHlWaWFDRE5Nb2R1bGUucGxvdGx5QnVuZGxlID0gYnVuZGxlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgbG9hZFZpYUNETihjZG5Qcm92aWRlcjogUGxvdGx5Q0ROUHJvdmlkZXIgPSAncGxvdGx5JywgY2RuVVJMOiBzdHJpbmcgPSAnJyk6IHZvaWQge1xyXG4gICAgICAgIFBsb3RseVNlcnZpY2Uuc2V0UGxvdGx5KCd3YWl0aW5nJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IGluaXQgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBzcmM6IHN0cmluZyA9ICcnO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGNkblByb3ZpZGVyKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjbG91ZGZsYXJlJzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoUGxvdGx5VmlhQ0ROTW9kdWxlLnBsb3RseVZlcnNpb24gPT0gJ2xhdGVzdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBcyBjbG91ZGZsYXJlIGhvc3RzIHZlcnNpb24gc3BlY2lmaWMgZmlsZXMsICdsYXRlc3QnIGFzIGEgdmVyc2lvbiBpcyBub3Qgc3VwcG9ydGVkLiBQbGVhc2Ugc3BlY2lmeSBhIHZlcnNpb24gb3IgeW91IGNhbiBjaG9vc2UgJ3Bsb3RseScgYXMgYSBDRE4gcHJvdmlkZXIuYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNyYyA9IFBsb3RseVZpYUNETk1vZHVsZS5wbG90bHlCdW5kbGUgPT0gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGBodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wbG90bHkuanMvJHtQbG90bHlWaWFDRE5Nb2R1bGUucGxvdGx5VmVyc2lvbn0vcGxvdGx5Lm1pbi5qc2BcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBgaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcGxvdGx5LmpzLyR7UGxvdGx5VmlhQ0ROTW9kdWxlLnBsb3RseVZlcnNpb259L3Bsb3RseS0ke1Bsb3RseVZpYUNETk1vZHVsZS5wbG90bHlCdW5kbGV9Lm1pbi5qc2A7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjdXN0b20nOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmKCEoISFjZG5VUkwgJiYgdHlwZW9mIGNkblVSTCA9PT0gJ3N0cmluZycpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBvciBtaXNzaW5nIENETiBVUkwuIFBsZWFzZSBwcm92aWRlIGEgQ0ROIFVSTCBpbiBjYXNlIG9mIGN1c3RvbSBwcm92aWRlci4gQWx0ZXJuYXRpdmVseSwgeW91IGNhbiBjaG9vc2UgZnJvbSAncGxvdGx5JyBvciAnY2xvdWRmbGFyZScuYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNyYyA9IGNkblVSTDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgc3JjID0gUGxvdGx5VmlhQ0ROTW9kdWxlLnBsb3RseUJ1bmRsZSA9PSBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gYGh0dHBzOi8vY2RuLnBsb3QubHkvcGxvdGx5LSR7UGxvdGx5VmlhQ0ROTW9kdWxlLnBsb3RseVZlcnNpb259Lm1pbi5qc2BcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBgaHR0cHM6Ly9jZG4ucGxvdC5seS9wbG90bHktJHtQbG90bHlWaWFDRE5Nb2R1bGUucGxvdGx5QnVuZGxlfS0ke1Bsb3RseVZpYUNETk1vZHVsZS5wbG90bHlWZXJzaW9ufS5taW4uanNgO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzY3JpcHQ6IEhUTUxTY3JpcHRFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XHJcbiAgICAgICAgICAgIHNjcmlwdC50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7XHJcbiAgICAgICAgICAgIHNjcmlwdC5zcmMgPSBzcmM7XHJcbiAgICAgICAgICAgIHNjcmlwdC5vbmVycm9yID0gKCkgPT4gY29uc29sZS5lcnJvcihgRXJyb3IgbG9hZGluZyBwbG90bHkuanMgbGlicmFyeSBmcm9tICR7c3JjfWApO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgaGVhZDogSFRNTEhlYWRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXTtcclxuICAgICAgICAgICAgaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGNvdW50ZXIgPSAyMDA7IC8vIGVxdWl2YWxlbnQgb2YgMTAgc2Vjb25kcy4uLlxyXG5cclxuICAgICAgICAgICAgY29uc3QgZm4gPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwbG90bHkgPSAod2luZG93IGFzIGFueSkuUGxvdGx5O1xyXG4gICAgICAgICAgICAgICAgaWYgKHBsb3RseSkge1xyXG4gICAgICAgICAgICAgICAgICAgIFBsb3RseVNlcnZpY2Uuc2V0UGxvdGx5KHBsb3RseSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvdW50ZXIgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY291bnRlciAtLTtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZuLCA1MCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgbG9hZGluZyBwbG90bHkuanMgbGlicmFyeSBmcm9tICR7c3JjfS4gVGltZW91dC5gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGZuKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgc2V0VGltZW91dChpbml0KTtcclxuICAgIH1cclxufVxyXG4iXX0=